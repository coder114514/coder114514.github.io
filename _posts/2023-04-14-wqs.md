---
title: wqs二分

tags: OI OI笔记
last_modified_at: 2023/04/14
---

[原始论文](https://pufanyi.github.io/%E7%94%9F%E6%88%90%E6%A0%91%E5%85%A5%E9%97%A8/Train2012-sol-wqs.pdf)

### 引入

我们有时候需要解决在一定限制下的最优化问题，通常它们可以写成如下形式：在 $g(x)=b$ 的情况下使 $f(x)$ 最小化（最大化）。

但是很多时候这样的问题难以直接解决，而相应的没有限制的问题通常会更容易解决（即求 $f(x)$ 的最小值）。

所以如果能从无限制问题中的结果得到有限制问题的结果，我们就能更容易地解决原问题。

### Lagrange Sufficiency  Theorem:

对于问题 $P$：使 $f(x)$ 最小化，其中 $g(x)=b, x\in X$

考虑无限制问题 $P'(\lambda)$：使 $f(x)-\lambda g(x)$ 最小化，其中 $x \in X$。

若 $P'(\lambda)$ 有满足 $g(x\_\*)=b$ 的解 $x\_\*$，那 $x\_\*$ 也是原问题 $P$ 的一个解。

该定理可以用反证法简单地证明。

由上述定理可以看到，如果 $g(x\_\*)$ 关于 $\lambda$ 有单调性，就可以通过二分 $\lambda$ 和解决 $P'(\lambda)$（比 $P$ 简单）来找到答案

而 $g(x\_\*)$ 关于 $\lambda$ 有单调性也意味着问题 $P$ 关于不同的限制 $b$ 具有凸性（a.k.a. $P(b)-P(b-1)\le P(b+1)-P(b)$）

一般来说，凸性可以通过暴力算法打印数据找规律~~猜蒙凑~~得出

### 经典题目

[最小黑白生成树](https://www.luogu.com.cn/problem/P2619)
